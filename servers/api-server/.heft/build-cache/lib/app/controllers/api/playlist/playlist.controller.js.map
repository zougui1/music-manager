{"version":3,"file":"playlist.controller.js","sourceRoot":"","sources":["../../../../../src/app/controllers/api/playlist/playlist.controller.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,qCAA6I;AAC7I,+CAAuD;AAIvD,MAAa,kBAAkB;IAmB7B,KAAK,CAAC,IAAI,CAAC,GAAyB;QAClC,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC;QACnE,OAAO,IAAI,qBAAc,CAAC,SAAS,CAAC,CAAC;IACvC,CAAC;IAGD,KAAK,CAAC,OAAO,CAAC,GAAY,EAAE,EAAE,EAAE,EAAkB;QAChD,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;QAEnD,IAAI,CAAC,QAAQ,EAAE;YACb,OAAO,IAAI,2BAAoB,EAAE,CAAC;SACnC;QAED,OAAO,IAAI,qBAAc,CAAC,QAAQ,CAAC,CAAC;IACtC,CAAC;IAGD,KAAK,CAAC,GAAG,CAAC,GAAyB;QACjC,MAAM,QAAQ,GAAG,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC;QAClC,MAAM,IAAI,CAAC,QAAQ,CAAC,MAAM,iBAAG,IAAI,EAAE,GAAG,CAAC,IAAI,IAAK,QAAQ,EAAG,CAAC;QAC5D,OAAO,IAAI,qBAAc,CAAC,QAAQ,CAAC,CAAC;IACtC,CAAC;IAGD,KAAK,CAAC,GAAG,KAA4B,OAAO,IAAI,qBAAc,EAAE,CAAC,CAAC,CAAC;IAGnE,KAAK,CAAC,MAAM,CAAC,GAAY,EAAE,EAAE,EAAE,EAAkB,EAAE,IAAmB;QACpE,MAAM,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,CAAC;QACzD,OAAO,IAAI,qBAAc,EAAE,CAAC;IAC9B,CAAC;IAGD,KAAK,CAAC,OAAO,KAA4B,OAAO,IAAI,qBAAc,EAAE,CAAC,CAAC,CAAC;CACxE;AAlDC;IADC,iBAAU;8BACA,uBAAQ;oDAAC;AAgBpB;IAdC,UAAG,CAAC,GAAG,CAAC;IACR,kBAAW,CAAC,GAAG,EAAE;QAChB,WAAW,EAAE,mBAAmB;QAChC,OAAO,EAAE;YACP,kBAAkB,EAAE;gBAClB,MAAM,EAAE;oBACN,IAAI,EAAE,OAAO;oBACb,KAAK,EAAE;wBACL,IAAI,EAAE,QAAQ;qBACf;iBACF;aACF;SACF;KACF,CAAC;;qCACc,cAAO;;8CAGtB;AAGD;IADC,UAAG,CAAC,MAAM,CAAC;;qCACO,cAAO;;iDAQzB;AAGD;IADC,WAAI,CAAC,GAAG,CAAC;;qCACK,cAAO;;6CAIrB;AAGD;IADC,cAAO,CAAC,GAAG,CAAC;;;;6CACsD;AAGnE;IADC,YAAK,CAAC,MAAM,CAAC;;qCACI,cAAO;;gDAGxB;AAGD;IADC,cAAO,CAAC,MAAM,CAAC;;;;iDACuD;AApDzE,gDAqDC","sourcesContent":["import { Context, dependency, Get, Post, Patch, Options, HttpResponse, HttpResponseOK, ApiResponse, HttpResponseNotFound } from '@foal/core';\nimport { Playlist, UpdateOptions } from 'playlist-pkg';\n\nimport { UserContext } from '../../../types';\n\nexport class PlaylistController {\n\n  @dependency\n  playlist!: Playlist;\n\n  @Get('/')\n  @ApiResponse(200, {\n    description: 'List of playlists',\n    content: {\n      'application/json': {\n        schema: {\n          type: 'array',\n          items: {\n            type: 'object',\n          }\n        }\n      }\n    }\n  })\n  async find(ctx: Context<UserContext>): Promise<HttpResponse> {\n    const playlists = await this.playlist.findMany({ user: ctx.user });\n    return new HttpResponseOK(playlists);\n  }\n\n  @Get('/:id')\n  async findOne(ctx: Context, { id }: { id: number }): Promise<HttpResponse> {\n    const playlist = await this.playlist.findById(+id);\n\n    if (!playlist) {\n      return new HttpResponseNotFound();\n    }\n\n    return new HttpResponseOK(playlist);\n  }\n\n  @Post('/')\n  async add(ctx: Context<UserContext>): Promise<HttpResponse> {\n    const playlist = ctx.request.body;\n    await this.playlist.create({ user: ctx.user, ...playlist });\n    return new HttpResponseOK(playlist);\n  }\n\n  @Options('/')\n  async opt(): Promise<HttpResponse> { return new HttpResponseOK(); }\n\n  @Patch('/:id')\n  async update(ctx: Context, { id }: { id: number }, body: UpdateOptions): Promise<HttpResponse> {\n    await this.playlist.update({ id, user: ctx.user }, body);\n    return new HttpResponseOK();\n  }\n\n  @Options('/:id')\n  async optById(): Promise<HttpResponse> { return new HttpResponseOK(); }\n}\n"]}
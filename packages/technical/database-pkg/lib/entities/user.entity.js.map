{"version":3,"file":"user.entity.js","sourceRoot":"","sources":["../../src/entities/user.entity.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,qCAAgF;AAChF,mDAAuC;AACvC,uCAAgC;AAEhC,+CAA2C;AAC3C,iDAA6C;AAC7C,uDAAmD;AAGnD,IAAa,UAAU,GAAvB,MAAa,UAAW,SAAQ,wBAAU;IAmBjC,KAAK,CAAC,YAAY;QACvB,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,SAAS,CAAC,EAAE;YACzD,IAAI,CAAC,QAAQ,GAAG,MAAM,eAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAC3C;IACH,CAAC;CACF,CAAA;AArBC;IADC,gBAAM,CAAC,SAAS,EAAE,EAAE,MAAM,EAAE,sBAAK,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;;wCACpC;AAGrB;IADC,gBAAM,CAAC,SAAS,EAAE,EAAE,MAAM,EAAE,sBAAK,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,CAAC;;yCACpC;AAGtB;IADC,gBAAM,CAAC,SAAS,CAAC;;4CACmB;AAGrC;IADC,mBAAS,CAAC,GAAG,EAAE,CAAC,gCAAc,EAAE,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC;;6CACvB;AAGpC;IADC,mBAAS,CAAC,GAAG,EAAE,CAAC,0BAAW,EAAE,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC;;0CACpB;AAI9B;IAFC,sBAAY,EAAE;IACd,sBAAY,EAAE;;;;8CAKd;AAvBU,UAAU;IADtB,gBAAM,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;GACb,UAAU,CAwBtB;AAxBY,gCAAU","sourcesContent":["import { Column, Entity, OneToMany, BeforeInsert, BeforeUpdate } from 'typeorm';\nimport { rules } from 'validation-pkg';\nimport { hash } from 'hash-pkg';\n\nimport { BaseEntity } from './base.entity';\nimport { MusicEntity } from './music.entity';\nimport { PlaylistEntity } from './playlist.entity';\n\n@Entity({ name: 'users' })\nexport class UserEntity extends BaseEntity {\n\n  @Column('varchar', { length: rules.user.name.maxLength })\n  public name!: string;\n\n  @Column('varchar', { length: rules.user.email.maxLength })\n  public email!: string;\n\n  @Column('varchar')\n  public password?: string | undefined;\n\n  @OneToMany(() => PlaylistEntity, playlist => playlist.user)\n  public playlists!: PlaylistEntity[];\n\n  @OneToMany(() => MusicEntity, music => music.user)\n  public musics!: MusicEntity[];\n\n  @BeforeInsert()\n  @BeforeUpdate()\n  public async hashPassword(): Promise<void> {\n    if (this.password && !this.password.startsWith('$argon2')) {\n      this.password = await hash(this.password);\n    }\n  }\n}\n"]}